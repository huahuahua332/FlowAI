# ğŸš€ AIè§†é¢‘ç”Ÿæˆå¹³å°å‰ç«¯å¼€å‘é›†æˆæŒ‡å—

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

### åŸºç¡€ä¿¡æ¯
- **APIåŸºç¡€åœ°å€**: `https://lbszbktvnuvn.sealoshzh.site`
- **APIç‰ˆæœ¬**: 1.0.0
- **è®¤è¯æ–¹å¼**: JWT Token + Google OAuth
- **Content-Type**: `application/json`
- **å“åº”æ ¼å¼**: JSON
- **æ”¯ä»˜ç³»ç»Ÿ**: Creem é›†æˆ
- **æ•°æ®åº“**: MongoDB (ç”Ÿäº§ç¯å¢ƒ)

### æ”¯æŒçš„AIè§†é¢‘ç”Ÿæˆæ¨¡å‹
| æ¨¡å‹ID | æ¨¡å‹åç§° | åŠŸèƒ½ | åˆ†è¾¨ç‡ | æ—¶é•¿ | è®¢é˜…è¦æ±‚ | ç§¯åˆ†æ¶ˆè€—(5s/10s) |
|--------|----------|------|--------|------|----------|------------------|
| `wan-i2v` | WAN I2V | å›¾ç‰‡è½¬è§†é¢‘ | 480p | 5-10ç§’ | å…è´¹ç‰ˆ+ | 22/32ç§¯åˆ† |
| `wan-t2v` | WAN T2V | æ–‡æœ¬è½¬è§†é¢‘ | 720p | 5-10ç§’ | Plusç‰ˆ+ | 45/65ç§¯åˆ† |
| `veo-3` | Google Veo-3 | é«˜è´¨é‡æ–‡æœ¬è½¬è§†é¢‘ | 1080p | 5-10ç§’ | æ——èˆ°ç‰ˆ | 70/140ç§¯åˆ† |

## ğŸ” è®¤è¯ç³»ç»Ÿ

### 1. Google OAuth ç™»å½•æµç¨‹

#### æ–¹æ³•1: ç›´æ¥è·³è½¬ç™»å½•
```javascript
function loginWithGoogle() {
    window.location.href = 'https://lbszbktvnuvn.sealoshzh.site/api/auth/google';
}
```

#### æ–¹æ³•2: å¼¹çª—ç™»å½•ï¼ˆæ¨èï¼‰
```javascript
function loginWithGooglePopup() {
    const popup = window.open(
        'https://lbszbktvnuvn.sealoshzh.site/api/auth/google',
        'google-login',
        'width=500,height=600,scrollbars=yes,resizable=yes'
    );
    
    window.addEventListener('message', (event) => {
        if (event.origin !== 'https://lbszbktvnuvn.sealoshzh.site') return;
        
        if (event.data.token) {
            localStorage.setItem('authToken', event.data.token);
            popup.close();
            handleLoginSuccess(event.data.token);
        }
    });
}
```

### 2. OAuthå›è°ƒå¤„ç†
```javascript
// åœ¨ /auth/callback é¡µé¢å¤„ç†token
function handleOAuthCallback() {
    const urlParams = new URLSearchParams(window.location.search);
    const token = urlParams.get('token');
    const userInfo = JSON.parse(decodeURIComponent(urlParams.get('user') || '{}'));
    const success = urlParams.get('success') === 'true';

    if (success && token) {
        localStorage.setItem('authToken', token);
        localStorage.setItem('user', JSON.stringify(userInfo));
        
        // å¦‚æœæ˜¯å¼¹çª—ç™»å½•ï¼Œå‘çˆ¶çª—å£å‘é€æ¶ˆæ¯
        if (window.opener) {
            window.opener.postMessage({ token, user: userInfo }, 'https://lbszbktvnuvn.sealoshzh.site');
            window.close();
            return;
        }
        
        // ç›´æ¥è·³è½¬ç™»å½•ï¼Œé‡å®šå‘åˆ°ä¸»é¡µ
        window.location.href = '/dashboard';
    } else {
        console.error('OAuthç™»å½•å¤±è´¥');
        window.location.href = '/login?error=oauth_failed';
    }
}
```

### 3. è®¤è¯APIç«¯ç‚¹

#### è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
```javascript
// GET /api/auth/me
async function getCurrentUser() {
    const token = localStorage.getItem('authToken');
    if (!token) throw new Error('æœªæ‰¾åˆ°è®¤è¯token');
    
    const response = await fetch('https://lbszbktvnuvn.sealoshzh.site/api/auth/me', {
        headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
        }
    });
    
    const data = await response.json();
    if (data.success) {
        return data.data.user;
    } else {
        throw new Error(data.message);
    }
}

// å“åº”æ•°æ®ç»“æ„
{
  "success": true,
  "data": {
    "user": {
      "_id": "user_id",
      "name": "ç”¨æˆ·å",
      "email": "user@example.com",
      "avatar": "å¤´åƒURL",
      "subscriptionLevel": "free", // 'free' | 'plus' | 'pro' | 'flagship'
      "points": 120,
      "lastSigninDate": "2024-01-15T00:00:00.000Z",
      "consecutiveSigninDays": 5,
      "monthlySigninDays": 15,
      "subscriptionExpiry": "2024-02-15T00:00:00.000Z",
      "isSubscriptionActive": true,
      "effectiveLevel": "plus",
      "createdAt": "2024-01-01T00:00:00.000Z"
    }
  }
}
```

#### ç”¨æˆ·ç™»å‡º
```javascript
// POST /api/auth/logout
async function logout() {
    const token = localStorage.getItem('authToken');
    
    try {
        await fetch('https://lbszbktvnuvn.sealoshzh.site/api/auth/logout', {
            method: 'POST',
            headers: {
                'Authorization': `Bearer ${token}`,
                'Content-Type': 'application/json'
            }
        });
    } catch (error) {
        console.error('ç™»å‡ºè¯·æ±‚å¤±è´¥:', error);
    } finally {
        localStorage.removeItem('authToken');
        localStorage.removeItem('user');
        window.location.href = '/login';
    }
}
```

## ğŸ¬ è§†é¢‘ç”ŸæˆAPI

### 1. ç»Ÿä¸€è§†é¢‘ç”Ÿæˆç«¯ç‚¹ï¼ˆæ¨èä½¿ç”¨ï¼‰

```javascript
// POST /api/generate/video
async function generateVideo(params) {
    const token = localStorage.getItem('authToken');
    
    const response = await fetch('https://lbszbktvnuvn.sealoshzh.site/api/generate/video', {
        method: 'POST',
        headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(params)
    });
    
    return await response.json();
}
```

### 2. ä¸åŒæ¨¡å‹çš„è¯·æ±‚å‚æ•°

#### æ–‡æœ¬è½¬è§†é¢‘ (wan-t2v)
```javascript
const params = {
    model: 'wan-t2v',
    prompt: 'ä¸€åªå¯çˆ±çš„å°çŒ«åœ¨èŠ±å›­é‡Œç©è€',
    duration: 5, // 5 æˆ– 10 ç§’
    batchSize: 1 // 1-4ä¸ªè§†é¢‘
};
```

#### å›¾ç‰‡è½¬è§†é¢‘ (wan-i2v)
```javascript
const params = {
    model: 'wan-i2v',
    prompt: 'è®©è¿™å¼ å›¾ç‰‡åŠ¨èµ·æ¥',
    image: 'data:image/jpeg;base64,/9j/4AAQSkZJRgABA...', // base64å›¾ç‰‡æ•°æ®
    duration: 5,
    batchSize: 1
};
```

#### é«˜è´¨é‡ç”Ÿæˆ (veo-3)
```javascript
const params = {
    model: 'veo-3',
    prompt: 'ç§‘å¹»åŸå¸‚çš„æœªæ¥æ™¯è±¡ï¼Œéœ“è™¹ç¯é—ªçƒ',
    duration: 10,
    batchSize: 2
};
```

### 3. å“åº”æ•°æ®ç»“æ„
```javascript
// æˆåŠŸå“åº”
{
    "success": true,
    "data": {
        "videoIds": ["video_id_1", "video_id_2"],
        "batchSize": 2,
        "status": "processing",
        "message": "æ‰¹é‡ç”Ÿæˆè¯·æ±‚å·²æäº¤ï¼Œæ­£åœ¨ç”Ÿæˆ 2 ä¸ªè§†é¢‘ï¼Œè¯·ç¨åæŸ¥çœ‹ç»“æœ",
        "model": "veo-3",
        "pointsUsed": 140
    }
}

// é”™è¯¯å“åº”
{
    "success": false,
    "message": "ç§¯åˆ†ä¸è¶³ï¼Œæ‰¹é‡ç”Ÿæˆ2ä¸ªè§†é¢‘éœ€è¦ 140 ç§¯åˆ†ï¼Œå½“å‰ç§¯åˆ†: 100",
    "code": "INSUFFICIENT_POINTS"
}
```

### 4. æŸ¥è¯¢è§†é¢‘ç”ŸæˆçŠ¶æ€
```javascript
// GET /api/generate/status/:videoId
async function getVideoStatus(videoId) {
    const token = localStorage.getItem('authToken');
    
    const response = await fetch(`https://lbszbktvnuvn.sealoshzh.site/api/generate/status/${videoId}`, {
        headers: {
            'Authorization': `Bearer ${token}`
        }
    });
    
    return await response.json();
}

// å“åº”ç¤ºä¾‹
{
    "success": true,
    "data": {
        "videoId": "video_id_1",
        "status": "completed", // 'pending' | 'processing' | 'completed' | 'failed'
        "videoUrl": "https://example.com/video.mp4",
        "thumbnailUrl": "https://example.com/thumb.jpg",
        "progress": 100,
        "model": "wan-t2v",
        "prompt": "ä¸€åªå¯çˆ±çš„å°çŒ«åœ¨èŠ±å›­é‡Œç©è€",
        "duration": 5,
        "pointsUsed": 45,
        "createdAt": "2024-01-01T12:00:00Z",
        "completedAt": "2024-01-01T12:05:00Z"
    }
}
```

### 5. è·å–è§†é¢‘ç”Ÿæˆå†å²
```javascript
// GET /api/generate/history?page=1&limit=10
async function getVideoHistory(page = 1, limit = 10) {
    const token = localStorage.getItem('authToken');
    
    const response = await fetch(`https://lbszbktvnuvn.sealoshzh.site/api/generate/history?page=${page}&limit=${limit}`, {
        headers: {
            'Authorization': `Bearer ${token}`
        }
    });
    
    return await response.json();
}

// å“åº”ç¤ºä¾‹
{
    "success": true,
    "data": {
        "videos": [
            {
                "videoId": "video_id_1",
                "status": "completed",
                "videoUrl": "https://example.com/video.mp4",
                "thumbnailUrl": "https://example.com/thumb.jpg",
                "model": "wan-t2v",
                "prompt": "ä¸€åªå¯çˆ±çš„å°çŒ«åœ¨èŠ±å›­é‡Œç©è€",
                "duration": 5,
                "pointsUsed": 45,
                "createdAt": "2024-01-01T12:00:00Z"
            }
        ],
        "pagination": {
            "page": 1,
            "limit": 10,
            "total": 25,
            "pages": 3,
            "hasNext": true,
            "hasPrev": false
        }
    }
}
```

## ğŸ‘¤ ç”¨æˆ·ç®¡ç†API

### 1. æ¯æ—¥ç­¾åˆ°ç³»ç»Ÿ

#### æ‰§è¡Œç­¾åˆ°
```javascript
// POST /api/user/signin
async function dailySignin() {
    const token = localStorage.getItem('authToken');
    
    const response = await fetch('https://lbszbktvnuvn.sealoshzh.site/api/user/signin', {
        method: 'POST',
        headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
        }
    });
    
    return await response.json();
}

// å“åº”ç¤ºä¾‹
{
    "success": true,
    "data": {
        "pointsEarned": 7, // åŸºç¡€2ç§¯åˆ† + è¿ç»­å¥–åŠ±5ç§¯åˆ†
        "consecutiveDays": 7,
        "monthlyDays": 15,
        "totalPoints": 127,
        "bonusMessage": "è¿ç»­7å¤©å¥–åŠ± 5 ç§¯åˆ†ï¼",
        "message": "ç­¾åˆ°æˆåŠŸï¼è·å¾— 7 ç§¯åˆ†"
    }
}
```

#### è·å–ç­¾åˆ°çŠ¶æ€
```javascript
// GET /api/user/signin-status
async function getSigninStatus() {
    const token = localStorage.getItem('authToken');
    
    const response = await fetch('https://lbszbktvnuvn.sealoshzh.site/api/user/signin-status', {
        headers: {
            'Authorization': `Bearer ${token}`
        }
    });
    
    return await response.json();
}

// å“åº”ç¤ºä¾‹
{
    "success": true,
    "data": {
        "hasSignedToday": false,
        "consecutiveDays": 6,
        "monthlyDays": 14,
        "lastSigninDate": "2024-01-14T12:00:00Z",
        "nextWeeklyReward": 1, // è·ç¦»ä¸‹æ¬¡7å¤©å¥–åŠ±è¿˜éœ€è¦1å¤©
        "nextMonthlyReward": 11, // è·ç¦»ä¸‹æ¬¡25å¤©å¥–åŠ±è¿˜éœ€è¦11å¤©
        "rewards": {
            "daily": 2,
            "weekly": 5, // è¿ç»­7å¤©å¥–åŠ±
            "monthly": 12 // è¿ç»­25å¤©å¥–åŠ±
        }
    }
}
```

### 2. ç”¨æˆ·ç»Ÿè®¡ä¿¡æ¯
```javascript
// GET /api/user/stats
async function getUserStats() {
    const token = localStorage.getItem('authToken');
    
    const response = await fetch('https://lbszbktvnuvn.sealoshzh.site/api/user/stats', {
        headers: {
            'Authorization': `Bearer ${token}`
        }
    });
    
    return await response.json();
}

// å“åº”ç¤ºä¾‹
{
    "success": true,
    "data": {
        "user": {
            "id": "user_id",
            "name": "ç”¨æˆ·å",
            "email": "user@example.com",
            "avatar": "å¤´åƒURL",
            "points": 150,
            "subscriptionLevel": "plus",
            "effectiveLevel": "plus",
            "subscriptionExpiry": "2024-02-15T00:00:00Z",
            "isSubscriptionActive": true
        },
        "stats": {
            "todayGenerations": 3,
            "totalGenerations": 25,
            "monthlyPointsUsed": 180,
            "consecutiveSigninDays": 6
        },
        "limits": {
            "monthlyGenerations": -1, // -1è¡¨ç¤ºæ— é™åˆ¶
            "maxDuration": 5,
            "allowedModels": ["wan-i2v", "wan-t2v"],
            "maxResolution": "720p",
            "batchSize": 1,
            "monthlyPoints": 120
        }
    }
}
```

### 3. ç§¯åˆ†å†å²è®°å½•
```javascript
// GET /api/user/points-history?page=1&limit=20
async function getPointsHistory(page = 1, limit = 20) {
    const token = localStorage.getItem('authToken');
    
    const response = await fetch(`https://lbszbktvnuvn.sealoshzh.site/api/user/points-history?page=${page}&limit=${limit}`, {
        headers: {
            'Authorization': `Bearer ${token}`
        }
    });
    
    return await response.json();
}

// å“åº”ç¤ºä¾‹
{
    "success": true,
    "data": {
        "history": [
            {
                "type": "video_generation",
                "points": -45,
                "description": "WAN T2V 5ç§’è§†é¢‘ç”Ÿæˆ",
                "videoId": "video_123",
                "createdAt": "2024-01-15T10:00:00.000Z"
            },
            {
                "type": "daily_signin",
                "points": 2,
                "description": "æ¯æ—¥ç­¾åˆ°å¥–åŠ±",
                "createdAt": "2024-01-15T09:00:00.000Z"
            },
            {
                "type": "subscription_reward",
                "points": 120,
                "description": "Plusç‰ˆè®¢é˜…å¥–åŠ±",
                "createdAt": "2024-01-01T00:00:00.000Z"
            }
        ],
        "pagination": {
            "current": 1,
            "total": 10,
            "count": 200,
            "hasNext": true,
            "hasPrev": false
        }
    }
}
```

## ğŸ’³ æ”¯ä»˜ç³»ç»ŸAPI

### 1. è®¢é˜…è®¡åˆ’

#### è®¢é˜…ç­‰çº§å¯¹æ¯”è¡¨
| ç­‰çº§ | æœˆè´¹ | å¹´è´¹ | æœˆåº¦ç§¯åˆ† | å¯ç”¨æ¨¡å‹ | æœ€å¤§æ—¶é•¿ | æ‰¹é‡ç”Ÿæˆ | æœ€é«˜åˆ†è¾¨ç‡ |
|------|------|------|----------|----------|----------|----------|------------|
| å…è´¹ç‰ˆ | $0 | - | 30 | WAN I2V | 5ç§’ | 1ä¸ª | 480P |
| Plusç‰ˆ | $12.99 | $9.99 | 120/1440 | I2V + T2V | 5ç§’ | 1ä¸ª | 720P |
| Proç‰ˆ | $36.99 | $29.99 | 380/4560 | I2V + T2V | 5-10ç§’ | 4ä¸ª | 720P |
| æ——èˆ°ç‰ˆ | $99.99 | $69.99 | 1000/12000 | å…¨éƒ¨æ¨¡å‹ | 5-10ç§’ | 4ä¸ª | 1080P |

#### è·å–è®¢é˜…è®¡åˆ’
```javascript
// GET /api/payment/plans
async function getSubscriptionPlans() {
    const response = await fetch('https://lbszbktvnuvn.sealoshzh.site/api/payment/plans');
    return await response.json();
}
```

#### åˆ›å»ºè®¢é˜…æ”¯ä»˜
```javascript
// POST /api/payment/create-subscription
async function createSubscriptionPayment(planId) {
    const token = localStorage.getItem('authToken');
    
    const response = await fetch('https://lbszbktvnuvn.sealoshzh.site/api/payment/create-subscription', {
        method: 'POST',
        headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            plan_id: planId
        })
    });
    
    const result = await response.json();
    
    if (result.success) {
        // é‡å®šå‘åˆ°æ”¯ä»˜é¡µé¢
        window.location.href = result.data.checkout_url;
    }
    
    return result;
}
```

### 2. ç§¯åˆ†å……å€¼åŒ…

#### ç§¯åˆ†åŒ…ä»·æ ¼è¡¨
| ç§¯åˆ†æ•°é‡ | ä»·æ ¼ | èµ é€ç§¯åˆ† | æ€»ç§¯åˆ† | æ¨è |
|----------|------|----------|--------|------|
| 100 | $9.99 | 10 | 110 | - |
| 250 | $22.99 | 25 | 275 | â­ |
| 500 | $44.99 | 50 | 550 | - |
| 1000 | $79.99 | 100 | 1100 | ğŸ’ |

#### è·å–ç§¯åˆ†å……å€¼åŒ…
```javascript
// GET /api/payment/points-packages
async function getPointsPackages() {
    const response = await fetch('https://lbszbktvnuvn.sealoshzh.site/api/payment/points-packages');
    return await response.json();
}
```

#### åˆ›å»ºç§¯åˆ†å……å€¼æ”¯ä»˜
```javascript
// POST /api/payment/create-points-payment
async function createPointsPayment(planId) {
    const token = localStorage.getItem('authToken');
    
    const response = await fetch('https://lbszbktvnuvn.sealoshzh.site/api/payment/create-points-payment', {
        method: 'POST',
        headers: {
            'Authorization': `Bearer ${token}`,
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            plan_id: planId
        })
    });
    
    const result = await response.json();
    
    if (result.success) {
        window.location.href = result.data.checkout_url;
    }
    
    return result;
}
```

## ğŸ› ï¸ å‰ç«¯é›†æˆå·¥å…·å‡½æ•°

### 1. APIè¯·æ±‚å°è£…
```javascript
class APIClient {
    constructor(baseURL = 'https://lbszbktvnuvn.sealoshzh.site') {
        this.baseURL = baseURL;
    }
    
    getToken() {
        return localStorage.getItem('authToken');
    }
    
    async request(endpoint, options = {}) {
        const token = this.getToken();
        
        const config = {
            headers: {
                'Content-Type': 'application/json',
                ...(token && { 'Authorization': `Bearer ${token}` }),
                ...options.headers
            },
            ...options
        };
        
        const response = await fetch(`${this.baseURL}${endpoint}`, config);
        
        // å¤„ç†401é”™è¯¯
        if (response.status === 401) {
            localStorage.removeItem('authToken');
            localStorage.removeItem('user');
            window.location.href = '/login';
            return;
        }
        
        return await response.json();
    }
    
    // GETè¯·æ±‚
    async get(endpoint) {
        return this.request(endpoint);
    }
    
    // POSTè¯·æ±‚
    async post(endpoint, data) {
        return this.request(endpoint, {
            method: 'POST',
            body: JSON.stringify(data)
        });
    }
}

// ä½¿ç”¨ç¤ºä¾‹
const api = new APIClient();

// è·å–ç”¨æˆ·ä¿¡æ¯
const user = await api.get('/api/auth/me');

// ç”Ÿæˆè§†é¢‘
const result = await api.post('/api/generate/video', {
    model: 'wan-t2v',
    prompt: 'ä¸€åªå¯çˆ±çš„å°çŒ«',
    duration: 5
});
```

### 2. æƒé™æ£€æŸ¥å‡½æ•°
```javascript
// æ£€æŸ¥ç”¨æˆ·æƒé™
function checkUserPermissions(user, selectedModel, duration, batchSize) {
    const limits = {
        free: {
            allowedModels: ['wan-i2v'],
            maxDuration: 5,
            batchSize: 1
        },
        plus: {
            allowedModels: ['wan-i2v', 'wan-t2v'],
            maxDuration: 5,
            batchSize: 1
        },
        pro: {
            allowedModels: ['wan-i2v', 'wan-t2v'],
            maxDuration: 10,
            batchSize: 4
        },
        flagship: {
            allowedModels: ['wan-i2v', 'wan-t2v', 'veo-3'],
            maxDuration: 10,
            batchSize: 4
        }
    };

    const userLimits = limits[user.subscriptionLevel] || limits.free;
    
    return {
        modelAllowed: userLimits.allowedModels.includes(selectedModel),
        durationAllowed: duration <= userLimits.maxDuration,
        batchSizeAllowed: batchSize <= userLimits.batchSize,
        needsUpgrade: !userLimits.allowedModels.includes(selectedModel)
    };
}
```

### 3. ç§¯åˆ†è®¡ç®—å‡½æ•°
```javascript
// è®¡ç®—ç§¯åˆ†æ¶ˆè€—
function calculatePoints(model, duration, batchSize = 1) {
    const pointsTable = {
        'wan-i2v': { 5: 22, 10: 32 },
        'wan-t2v': { 5: 45, 10: 65 },
        'veo-3': { 5: 70, 10: 140 }
    };
    
    const singlePoints = pointsTable[model][duration];
    return singlePoints * batchSize;
}

// æ£€æŸ¥ç§¯åˆ†æ˜¯å¦è¶³å¤Ÿ
function checkSufficientPoints(userPoints, model, duration, batchSize) {
    const requiredPoints = calculatePoints(model, duration, batchSize);
    return {
        sufficient: userPoints >= requiredPoints,
        required: requiredPoints,
        current: userPoints,
        shortage: Math.max(0, requiredPoints - userPoints)
    };
}
```

### 4. è§†é¢‘çŠ¶æ€è½®è¯¢
```javascript
// è½®è¯¢è§†é¢‘ç”ŸæˆçŠ¶æ€
function pollVideoStatus(videoId, callback, interval = 3000) {
    const api = new APIClient();
    
    const poll = async () => {
        try {
            const response = await api.get(`/api/generate/status/${videoId}`);
            
            if (response.success) {
                const video = response.data;
                callback(video);
                
                if (video.status === 'processing') {
                    setTimeout(poll, interval);
                } else {
                    // ç”Ÿæˆå®Œæˆæˆ–å¤±è´¥
                    return;
                }
            }
        } catch (error) {
            console.error('æŸ¥è¯¢è§†é¢‘çŠ¶æ€å¤±è´¥:', error);
            setTimeout(poll, interval * 2); // é”™è¯¯æ—¶å»¶é•¿é—´éš”
        }
    };
    
    poll();
}

// ä½¿ç”¨ç¤ºä¾‹
pollVideoStatus('video_123', (video) => {
    console.log('è§†é¢‘çŠ¶æ€æ›´æ–°:', video.status);
    
    if (video.status === 'completed') {
        console.log('è§†é¢‘ç”Ÿæˆå®Œæˆ:', video.videoUrl);
    } else if (video.status === 'failed') {
        console.log('è§†é¢‘ç”Ÿæˆå¤±è´¥:', video.error);
    }
});
```

## ğŸ“± React Hook ç¤ºä¾‹

### useAuth Hook
```javascript
import { useState, useEffect } from 'react';

export const useAuth = () => {
    const [user, setUser] = useState(null);
    const [token, setToken] = useState(localStorage.getItem('authToken'));
    const [loading, setLoading] = useState(true);

    useEffect(() => {
        if (token) {
            fetchUserInfo();
        } else {
            setLoading(false);
        }
    }, [token]);

    const fetchUserInfo = async () => {
        try {
            const api = new APIClient();
            const response = await api.get('/api/auth/me');
            
            if (response.success) {
                setUser(response.data.user);
            } else {
                logout();
            }
        } catch (error) {
            console.error('è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', error);
            logout();
        } finally {
            setLoading(false);
        }
    };

    const login = () => {
        window.location.href = 'https://lbszbktvnuvn.sealoshzh.site/api/auth/google';
    };

    const logout = () => {
        localStorage.removeItem('authToken');
        localStorage.removeItem('user');
        setUser(null);
        setToken(null);
    };

    return { user, token, loading, login, logout, fetchUserInfo };
};
```

### useVideoGeneration Hook
```javascript
import { useState } from 'react';

export const useVideoGeneration = () => {
    const [loading, setLoading] = useState(false);
    const [videos, setVideos] = useState([]);

    const generateVideo = async (params) => {
        setLoading(true);
        
        try {
            const api = new APIClient();
            const response = await api.post('/api/generate/video', params);

            if (response.success) {
                const newVideos = response.data.videoIds.map(id => ({
                    id,
                    status: 'processing',
                    model: params.model,
                    prompt: params.prompt,
                    createdAt: new Date().toISOString()
                }));
                
                setVideos(prev => [...newVideos, ...prev]);
                
                // å¼€å§‹è½®è¯¢çŠ¶æ€
                newVideos.forEach(video => {
                    pollVideoStatus(video.id, (updatedVideo) => {
                        setVideos(prev => prev.map(v => 
                            v.id === video.id ? { ...v, ...updatedVideo } : v
                        ));
                    });
                });
                
                return response;
            } else {
                throw new Error(response.message);
            }
        } catch (error) {
            console.error('è§†é¢‘ç”Ÿæˆå¤±è´¥:', error);
            throw error;
        } finally {
            setLoading(false);
        }
    };

    return { loading, videos, generateVideo };
};
```

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹

1. **Token å­˜å‚¨**: ä½¿ç”¨ `localStorage` å­˜å‚¨ JWT Token
2. **HTTPS**: ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨ HTTPS
3. **CORS**: åç«¯å·²é…ç½® CORSï¼Œæ”¯æŒè·¨åŸŸè¯·æ±‚
4. **å†…å®¹å®¡æ ¸**: æ‰€æœ‰æç¤ºè¯ä¼šç»è¿‡ OpenAI å†…å®¹å®¡æ ¸
5. **é€Ÿç‡é™åˆ¶**: API æœ‰é€Ÿç‡é™åˆ¶ï¼Œæ³¨æ„å¤„ç† 429 é”™è¯¯
6. **æ–‡ä»¶ä¸Šä¼ **: å›¾ç‰‡éœ€è¦è½¬æ¢ä¸º base64 æ ¼å¼ä¸Šä¼ 

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- **æœåŠ¡å™¨çŠ¶æ€**: https://lbszbktvnuvn.sealoshzh.site/health
- **APIæ–‡æ¡£**: æœ¬æ–‡æ¡£
- **é”™è¯¯æ—¥å¿—**: æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°å’Œç½‘ç»œè¯·æ±‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0  
**æœ€åæ›´æ–°**: 2024å¹´6æœˆ19æ—¥  
**æœåŠ¡çŠ¶æ€**: ğŸŸ¢ æ­£å¸¸è¿è¡Œ  
**ç»´æŠ¤è€…**: åç«¯å¼€å‘å›¢é˜Ÿ 